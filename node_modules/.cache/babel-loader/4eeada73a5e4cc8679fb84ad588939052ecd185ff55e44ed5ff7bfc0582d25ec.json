{"ast":null,"code":"import { ChatOpenAI } from \"langchain/chat_models/openai\";\nimport { HumanMessage, SystemMessage } from \"langchain/schema\";\n\n// this class is responsible for processing new messages from the user and getting a reply from OpenAI\n// it uses a human/system messages array that is sent in continously to OpenAI\n// you can log the newMessage and oldMessages to see what they look like\n\nclass LangchainProcessor {\n  async process(newMessage, oldMessages) {\n    // (!!) remember to add your OpenAI API key to the .env file\n    const chat = new ChatOpenAI({\n      temperature: 0,\n      openAIApiKey: process.env.REACT_APP_OPEN_AI_API_KEY\n    });\n    try {\n      // recreate the formatted messages array with the previous messages every time a new message comes in from the user\n      const formattedMessages = oldMessages.map(msg => {\n        if (msg.type === \"bot\") {\n          return new SystemMessage(msg.message);\n        } else {\n          return new HumanMessage(msg.message);\n        }\n      });\n\n      // Add the new human message to the list\n      formattedMessages.push(new HumanMessage(newMessage));\n\n      // call OpenAI to get a reply\n      const result = await chat.predictMessages(formattedMessages);\n\n      // Extract the content from the AIMessage\n      const botResponseContent = result.content;\n\n      // return the response\n      return botResponseContent;\n    } catch (error) {\n      console.error(\"Error processing message with OpenAI:\", error);\n      return \"Sorry, I faced an error processing your message.\";\n    }\n  }\n}\nexport default LangchainProcessor;","map":{"version":3,"names":["ChatOpenAI","HumanMessage","SystemMessage","LangchainProcessor","process","newMessage","oldMessages","chat","temperature","openAIApiKey","env","REACT_APP_OPEN_AI_API_KEY","formattedMessages","map","msg","type","message","push","result","predictMessages","botResponseContent","content","error","console"],"sources":["/Users/idasilfverskiold/gptSandbox/reactlangchain/sandbox/src/components/LangchainProcessor.js"],"sourcesContent":["import { ChatOpenAI } from \"langchain/chat_models/openai\";\nimport { HumanMessage, SystemMessage } from \"langchain/schema\";\n\n// this class is responsible for processing new messages from the user and getting a reply from OpenAI\n// it uses a human/system messages array that is sent in continously to OpenAI\n// you can log the newMessage and oldMessages to see what they look like\n\nclass LangchainProcessor {\n\n    async process(newMessage, oldMessages) {\n\n        // (!!) remember to add your OpenAI API key to the .env file\n        const chat = new ChatOpenAI({\n            temperature: 0,\n            openAIApiKey: process.env.REACT_APP_OPEN_AI_API_KEY\n        });\n\n        try {\n            // recreate the formatted messages array with the previous messages every time a new message comes in from the user\n            const formattedMessages = oldMessages.map(msg => {\n                if (msg.type === \"bot\") {\n                    return new SystemMessage(msg.message);\n                } else  {\n                    return new HumanMessage(msg.message);\n                } \n            });\n\n            // Add the new human message to the list\n            formattedMessages.push(new HumanMessage(newMessage));\n\n            // call OpenAI to get a reply\n            const result = await chat.predictMessages(formattedMessages);\n\n            // Extract the content from the AIMessage\n            const botResponseContent = result.content;\n\n             // return the response\n            return botResponseContent;\n\n        } catch (error) {\n            console.error(\"Error processing message with OpenAI:\", error);\n            return \"Sorry, I faced an error processing your message.\";\n        }\n    }\n}\n\nexport default LangchainProcessor;\n"],"mappings":"AAAA,SAASA,UAAU,QAAQ,8BAA8B;AACzD,SAASC,YAAY,EAAEC,aAAa,QAAQ,kBAAkB;;AAE9D;AACA;AACA;;AAEA,MAAMC,kBAAkB,CAAC;EAErB,MAAMC,OAAOA,CAACC,UAAU,EAAEC,WAAW,EAAE;IAEnC;IACA,MAAMC,IAAI,GAAG,IAAIP,UAAU,CAAC;MACxBQ,WAAW,EAAE,CAAC;MACdC,YAAY,EAAEL,OAAO,CAACM,GAAG,CAACC;IAC9B,CAAC,CAAC;IAEF,IAAI;MACA;MACA,MAAMC,iBAAiB,GAAGN,WAAW,CAACO,GAAG,CAACC,GAAG,IAAI;QAC7C,IAAIA,GAAG,CAACC,IAAI,KAAK,KAAK,EAAE;UACpB,OAAO,IAAIb,aAAa,CAACY,GAAG,CAACE,OAAO,CAAC;QACzC,CAAC,MAAO;UACJ,OAAO,IAAIf,YAAY,CAACa,GAAG,CAACE,OAAO,CAAC;QACxC;MACJ,CAAC,CAAC;;MAEF;MACAJ,iBAAiB,CAACK,IAAI,CAAC,IAAIhB,YAAY,CAACI,UAAU,CAAC,CAAC;;MAEpD;MACA,MAAMa,MAAM,GAAG,MAAMX,IAAI,CAACY,eAAe,CAACP,iBAAiB,CAAC;;MAE5D;MACA,MAAMQ,kBAAkB,GAAGF,MAAM,CAACG,OAAO;;MAExC;MACD,OAAOD,kBAAkB;IAE7B,CAAC,CAAC,OAAOE,KAAK,EAAE;MACZC,OAAO,CAACD,KAAK,CAAC,uCAAuC,EAAEA,KAAK,CAAC;MAC7D,OAAO,kDAAkD;IAC7D;EACJ;AACJ;AAEA,eAAenB,kBAAkB"},"metadata":{},"sourceType":"module","externalDependencies":[]}